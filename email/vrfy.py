#!/usr/bin/python3

import socket
import sys

if len(sys.argv) != 3:
    print("Usage: vrfy.py <host> <username>")
    sys.exit(0)

host = sys.argv[1]
user = sys.argv[2]

print("Testing " + host)

# create the socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# connect to the server
connect = s.connect((host, 25))

# get banner
banner = s.recv(1024)
print('[*] banner = ' + str(banner))

# VRFY the user
user_bytes = bytes('VRFY ' + user + '\r\n', 'ascii')
s.send(user_bytes)
result = s.recv(1024)
print('[*] result = ' + str(result))

# close socket
s.close()
