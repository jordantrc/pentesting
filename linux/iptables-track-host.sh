#!/bin/bash
#
# Adds rules to iptables to track the traffic sent to and received
# from a particular host.
#

host=$1

# check that a host was given
if [ -z $host ]; then
    echo "Usage: iptables-track-host.sh <host ip>"
    exit 0
fi

# flush all chains
iptables -F

# add monitoring to INPUT chain
iptables -I INPUT 1 -s $host -j ACCEPT

# add monitoring to OUTPUT chain
iptables -I OUTPUT 1 -d $host -j ACCEPT

# clear counters
iptables -Z
